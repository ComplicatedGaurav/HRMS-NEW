{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"F:\\\\Human-Resource-management-master\\\\client\\\\src\\\\context.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nconst Context = /*#__PURE__*/React.createContext();\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"LOGGED_IN\":\n      return { ...state,\n        token: action.payload.token,\n        user: action.payload.user\n      };\n\n    case \"LOGGED_OUT\":\n      return { ...state,\n        token: undefined,\n        user: undefined\n      };\n\n    case \"APPROVED_REJECTED_LEAVE\":\n      return { ...state,\n        user: { ...state.user,\n          leaveRequests: state.user.leaveRequests.filter(req => req.reqId !== action.payload.reqId)\n        }\n      };\n\n    case \"APPROVED_REJECTED_BONUS\":\n      return { ...state,\n        user: { ...state.user,\n          bonusRequests: state.user.bonusRequests.filter(req => req.reqId !== action.payload.reqId)\n        }\n      };\n\n    case \"APPROVED_REJECTED_LOAN\":\n      return { ...state,\n        user: { ...state.user,\n          loanRequests: state.user.loanRequests.filter(req => req.reqId !== action.payload.reqId)\n        }\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport class Provider extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      user: undefined,\n      token: undefined,\n      dispatch: action => this.setState(state => reducer(state, action))\n    };\n  }\n\n  async componentDidMount() {\n    // check if logged in\n    let token = localStorage.getItem(\"auth-token\");\n\n    if (token === null) {\n      localStorage.setItem(\"auth-token\", \"\");\n      token = \"\";\n    }\n\n    try {\n      // first check in admin model\n      const tokenRes = await axios.post(\"/api/admin/tokenIsValid\", null, {\n        headers: {\n          \"x-auth-token\": token\n        }\n      });\n\n      if (tokenRes.data) {\n        //logged in\n        const adminRes = await axios.get(\"/api/admin\", {\n          headers: {\n            \"x-auth-token\": token\n          }\n        });\n        this.setState({\n          token,\n          user: adminRes.data.user\n        });\n      } else {\n        // now check in users model\n        const tokenRes = await axios.post(\"/api/users/tokenIsValid\", null, {\n          headers: {\n            \"x-auth-token\": token\n          }\n        });\n\n        if (tokenRes.data) {\n          // console.log(\"emp logged in\");\n          //logged in\n          const userRes = await axios.get(\"/api/users\", {\n            headers: {\n              \"x-auth-token\": token\n            }\n          });\n          this.setState({\n            token,\n            user: userRes.data.user\n          });\n        }\n      }\n    } catch (err) {\n      console.log(\"ERROR: \", err);\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Context.Provider, {\n      value: this.state,\n      children: this.props.children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this);\n  }\n\n}\nexport const Consumer = Context.Consumer;","map":{"version":3,"sources":["F:/Human-Resource-management-master/client/src/context.js"],"names":["React","Component","axios","Context","createContext","reducer","state","action","type","token","payload","user","undefined","leaveRequests","filter","req","reqId","bonusRequests","loanRequests","Provider","constructor","props","dispatch","setState","componentDidMount","localStorage","getItem","setItem","tokenRes","post","headers","data","adminRes","get","userRes","err","console","log","render","children","Consumer"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\n\nconst Context = React.createContext();\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"LOGGED_IN\":\n      return {\n        ...state,\n        token: action.payload.token,\n        user: action.payload.user,\n      };\n\n    case \"LOGGED_OUT\":\n      return {\n        ...state,\n        token: undefined,\n        user: undefined,\n      };\n\n    case \"APPROVED_REJECTED_LEAVE\":\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          leaveRequests: state.user.leaveRequests.filter(\n            (req) => req.reqId !== action.payload.reqId\n          ),\n        },\n      };\n\n    case \"APPROVED_REJECTED_BONUS\":\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          bonusRequests: state.user.bonusRequests.filter(\n            (req) => req.reqId !== action.payload.reqId\n          ),\n        },\n      };\n\n    case \"APPROVED_REJECTED_LOAN\":\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          loanRequests: state.user.loanRequests.filter(\n            (req) => req.reqId !== action.payload.reqId\n          ),\n        },\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport class Provider extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      user: undefined,\n      token: undefined,\n      dispatch: (action) => this.setState((state) => reducer(state, action)),\n    };\n  }\n\n  async componentDidMount() {\n    // check if logged in\n    let token = localStorage.getItem(\"auth-token\");\n    if (token === null) {\n      localStorage.setItem(\"auth-token\", \"\");\n      token = \"\";\n    }\n\n    try {\n      // first check in admin model\n      const tokenRes = await axios.post(\"/api/admin/tokenIsValid\", null, {\n        headers: { \"x-auth-token\": token },\n      });\n      if (tokenRes.data) {\n        //logged in\n        const adminRes = await axios.get(\"/api/admin\", {\n          headers: { \"x-auth-token\": token },\n        });\n        this.setState({\n          token,\n          user: adminRes.data.user,\n        });\n      } else {\n        // now check in users model\n        const tokenRes = await axios.post(\"/api/users/tokenIsValid\", null, {\n          headers: { \"x-auth-token\": token },\n        });\n        if (tokenRes.data) {\n          // console.log(\"emp logged in\");\n\n          //logged in\n          const userRes = await axios.get(\"/api/users\", {\n            headers: { \"x-auth-token\": token },\n          });\n          this.setState({\n            token,\n            user: userRes.data.user,\n          });\n        }\n      }\n    } catch (err) {\n      console.log(\"ERROR: \", err);\n    }\n  }\n\n  render() {\n    return (\n      <Context.Provider value={this.state}>\n        {this.props.children}\n      </Context.Provider>\n    );\n  }\n}\n\nexport const Consumer = Context.Consumer;\n"]},"metadata":{},"sourceType":"module"}
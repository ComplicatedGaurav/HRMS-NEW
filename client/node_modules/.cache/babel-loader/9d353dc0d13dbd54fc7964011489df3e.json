{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\panka\\\\Downloads\\\\Human-Resource-management-master\\\\client\\\\src\\\\components\\\\layouts\\\\Admin\\\\View Requests\\\\ViewRequests.jsx\";\nimport axios from \"axios\";\nimport React, { Component } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { Consumer } from \"../../../../context\";\nimport AdminSidePanel from \"../AdminSidePanel\";\nimport BonusRequestCard from \"./BonusRequestCard\";\nimport LeaveRequestCard from \"./LeaveRequestCard\";\nimport LoanRequestCard from \"./LoanRequestCard\";\nimport classNames from \"classnames\";\nimport { Spring } from \"react-spring/renderprops\";\nexport default class ViewRequests extends Component {\n  constructor() {\n    super();\n\n    this.componentDidMount = async () => {\n      try {\n        const token = localStorage.getItem(\"auth-token\");\n        const tokenRes = await axios.post(\"/api/admin/tokenIsValid\", null, {\n          headers: {\n            \"x-auth-token\": token\n          }\n        });\n\n        if (tokenRes.data) {\n          //logged in\n          const adminRes = await axios.get(\"/api/admin\", {\n            headers: {\n              \"x-auth-token\": token\n            }\n          });\n          console.log(\"admin profile: \", adminRes.data.user);\n          this.setState({\n            admin: adminRes.data.user\n          });\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.callDispatch = (dispatch, req) => {\n      switch (req.title) {\n        case \"leave request\":\n          let leaveUser = this.state.admin;\n          leaveUser.leaveRequests = leaveUser.leaveRequests.filter(eachReq => eachReq.reqId !== req.reqId);\n          this.setState({\n            admin: leaveUser\n          });\n          dispatch({\n            type: \"APPROVED_REJECTED_LEAVE\",\n            payload: {\n              reqId: req.reqId\n            }\n          });\n          break;\n\n        case \"bonus request\":\n          let bonusUser = this.state.admin;\n          bonusUser.bonusRequests = bonusUser.bonusRequests.filter(eachReq => eachReq.reqId !== req.reqId);\n          this.setState({\n            admin: bonusUser\n          });\n          dispatch({\n            type: \"APPROVED_REJECTED_BONUS\",\n            payload: {\n              reqId: req.reqId\n            }\n          });\n          break;\n\n        case \"loan request\":\n          let loanUser = this.state.admin;\n          loanUser.loanRequests = loanUser.loanRequests.filter(eachReq => eachReq.reqId !== req.reqId);\n          this.setState({\n            admin: loanUser\n          });\n          dispatch({\n            type: \"APPROVED_REJECTED_LOAN\",\n            payload: {\n              reqId: req.reqId\n            }\n          });\n          break;\n\n        default:\n          return;\n      }\n    };\n\n    this.onApprove = async (req, dispatch) => {\n      this.callDispatch(dispatch, req);\n      console.log(\"approving: \", req);\n      req.approved = true;\n      req.ticketClosed = true;\n\n      try {\n        const adminId = localStorage.getItem(\"userId\");\n        const res = await axios.put(\"/api/admin/takeAction\", {\n          userReq: req,\n          adminId: adminId\n        });\n        console.log(\"approved successfully\", res.data);\n      } catch (e) {\n        console.log(\"Error: \", e.response.data.msg);\n      }\n    };\n\n    this.onReject = async (req, dispatch) => {\n      this.callDispatch(dispatch, req);\n      console.log(\"rejecting: \", req);\n      req.approved = false;\n      req.ticketClosed = true;\n\n      try {\n        const adminId = localStorage.getItem(\"userId\");\n        const res = await axios.put(\"/api/admin/takeAction\", {\n          userReq: req,\n          adminId: adminId\n        });\n        console.log(\"rejected successfully: \", res.data);\n      } catch (e) {\n        console.log(\"Error: \", e.response);\n      }\n    };\n\n    this.state = {\n      admin: undefined,\n      expandLeaveReq: true,\n      expandBonusReq: false,\n      expandLoanReq: false\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Consumer, {\n      children: value => {\n        let {\n          admin\n        } = this.state;\n        let {\n          user\n        } = value;\n        const token = localStorage.getItem(\"auth-token\");\n        if (!token) return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 30\n        }, this);\n        if (user && user.role !== \"admin\") return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/empDashBoard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 20\n        }, this);\n        return /*#__PURE__*/_jsxDEV(Spring, {\n          from: {\n            opacity: 0\n          },\n          to: {\n            opacity: 1\n          },\n          config: {\n            duration: 300\n          },\n          children: props => /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row m-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-2 p-0 leftPart\",\n                children: /*#__PURE__*/_jsxDEV(AdminSidePanel, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col\",\n                style: props,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"container py-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: [\"Leave Requests\", \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"badge badge-pill badge-dark\",\n                      style: {\n                        fontSize: \"15px\"\n                      },\n                      children: admin && admin.leaveRequests.length\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 179,\n                      columnNumber: 27\n                    }, this), \" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                      style: {\n                        cursor: \"pointer\"\n                      },\n                      onClick: () => this.setState({\n                        expandLeaveReq: !this.state.expandLeaveReq\n                      }),\n                      className: classNames(\"fa\", {\n                        \"fa-caret-down\": !this.state.expandLeaveReq,\n                        \"fa-caret-up\": this.state.expandLeaveReq\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 187,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 177,\n                    columnNumber: 25\n                  }, this), this.state.expandLeaveReq ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: \"flex\",\n                      flexDirection: \"row\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"row\",\n                      children: admin ? admin.leaveRequests.length ? admin.leaveRequests.map((req, index) => {\n                        return /*#__PURE__*/_jsxDEV(LeaveRequestCard, {\n                          req: req,\n                          onApprove: this.onApprove,\n                          onReject: this.onReject\n                        }, index, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 213,\n                          columnNumber: 39\n                        }, this);\n                      }) : /*#__PURE__*/_jsxDEV(\"small\", {\n                        className: \"ml-4\",\n                        children: \"No leave requests pending...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 222,\n                        columnNumber: 35\n                      }, this) : /*#__PURE__*/_jsxDEV(\"small\", {\n                        className: \"ml-4\",\n                        children: \"Loading leave requests...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 227,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 208,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 202,\n                    columnNumber: 27\n                  }, this) : null, /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 234,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: [\"Bonus Requests\", \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"badge badge-pill badge-dark\",\n                      style: {\n                        fontSize: \"15px\"\n                      },\n                      children: admin && admin.bonusRequests.length\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 238,\n                      columnNumber: 27\n                    }, this), \" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                      style: {\n                        cursor: \"pointer\"\n                      },\n                      onClick: () => this.setState({\n                        expandBonusReq: !this.state.expandBonusReq\n                      }),\n                      className: classNames(\"fa\", {\n                        \"fa-caret-down\": !this.state.expandBonusReq,\n                        \"fa-caret-up\": this.state.expandBonusReq\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 246,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 236,\n                    columnNumber: 25\n                  }, this), this.state.expandBonusReq ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: \"flex\",\n                      flexDirection: \"row\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"row\",\n                      children: admin ? admin.bonusRequests.length ? admin.bonusRequests.map((req, index) => {\n                        return /*#__PURE__*/_jsxDEV(BonusRequestCard, {\n                          req: req,\n                          onApprove: this.onApprove,\n                          onReject: this.onReject\n                        }, index, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 272,\n                          columnNumber: 39\n                        }, this);\n                      }) : /*#__PURE__*/_jsxDEV(\"small\", {\n                        className: \"ml-4\",\n                        children: \"No bonus requests pending...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 281,\n                        columnNumber: 35\n                      }, this) : /*#__PURE__*/_jsxDEV(\"small\", {\n                        className: \"ml-4\",\n                        children: \"Loading bonus requests...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 286,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 267,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 261,\n                    columnNumber: 27\n                  }, this) : null, /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: [\"Loan Requests\", \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"badge badge-pill badge-dark\",\n                      style: {\n                        fontSize: \"15px\"\n                      },\n                      children: admin && admin.loanRequests.length\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 298,\n                      columnNumber: 27\n                    }, this), \" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                      style: {\n                        cursor: \"pointer\"\n                      },\n                      onClick: () => this.setState({\n                        expandLoanReq: !this.state.expandLoanReq\n                      }),\n                      className: classNames(\"fa\", {\n                        \"fa-caret-down\": !this.state.expandLoanReq,\n                        \"fa-caret-up\": this.state.expandLoanReq\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 306,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 296,\n                    columnNumber: 25\n                  }, this), this.state.expandLoanReq ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: \"flex\",\n                      flexDirection: \"row\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"row\",\n                      children: admin ? admin.loanRequests.length ? admin.loanRequests.map((req, index) => {\n                        return /*#__PURE__*/_jsxDEV(LoanRequestCard, {\n                          req: req,\n                          onApprove: this.onApprove,\n                          onReject: this.onReject\n                        }, index, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 332,\n                          columnNumber: 39\n                        }, this);\n                      }) : /*#__PURE__*/_jsxDEV(\"small\", {\n                        className: \"ml-4\",\n                        children: \"No loan requests pending...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 341,\n                        columnNumber: 35\n                      }, this) : /*#__PURE__*/_jsxDEV(\"small\", {\n                        className: \"ml-4\",\n                        children: \"Loaing loan requests...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 346,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 327,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 321,\n                    columnNumber: 27\n                  }, this) : null]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 19\n            }, this)\n          }, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 13\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/panka/Downloads/Human-Resource-management-master/client/src/components/layouts/Admin/View Requests/ViewRequests.jsx"],"names":["axios","React","Component","Redirect","Consumer","AdminSidePanel","BonusRequestCard","LeaveRequestCard","LoanRequestCard","classNames","Spring","ViewRequests","constructor","componentDidMount","token","localStorage","getItem","tokenRes","post","headers","data","adminRes","get","console","log","user","setState","admin","e","callDispatch","dispatch","req","title","leaveUser","state","leaveRequests","filter","eachReq","reqId","type","payload","bonusUser","bonusRequests","loanUser","loanRequests","onApprove","approved","ticketClosed","adminId","res","put","userReq","response","msg","onReject","undefined","expandLeaveReq","expandBonusReq","expandLoanReq","render","value","role","opacity","duration","props","fontSize","length","cursor","display","flexDirection","map","index"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React, { Component } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { Consumer } from \"../../../../context\";\nimport AdminSidePanel from \"../AdminSidePanel\";\nimport BonusRequestCard from \"./BonusRequestCard\";\nimport LeaveRequestCard from \"./LeaveRequestCard\";\nimport LoanRequestCard from \"./LoanRequestCard\";\nimport classNames from \"classnames\";\nimport { Spring } from \"react-spring/renderprops\";\n\nexport default class ViewRequests extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      admin: undefined,\n\n      expandLeaveReq: true,\n      expandBonusReq: false,\n      expandLoanReq: false,\n    };\n  }\n\n  componentDidMount = async () => {\n    try {\n      const token = localStorage.getItem(\"auth-token\");\n      const tokenRes = await axios.post(\"/api/admin/tokenIsValid\", null, {\n        headers: { \"x-auth-token\": token },\n      });\n\n      if (tokenRes.data) {\n        //logged in\n        const adminRes = await axios.get(\"/api/admin\", {\n          headers: { \"x-auth-token\": token },\n        });\n        console.log(\"admin profile: \", adminRes.data.user);\n        this.setState({\n          admin: adminRes.data.user,\n        });\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  callDispatch = (dispatch, req) => {\n    switch (req.title) {\n      case \"leave request\":\n        let leaveUser = this.state.admin;\n        leaveUser.leaveRequests = leaveUser.leaveRequests.filter(\n          (eachReq) => eachReq.reqId !== req.reqId\n        );\n\n        this.setState({\n          admin: leaveUser,\n        });\n\n        dispatch({\n          type: \"APPROVED_REJECTED_LEAVE\",\n          payload: {\n            reqId: req.reqId,\n          },\n        });\n        break;\n\n      case \"bonus request\":\n        let bonusUser = this.state.admin;\n        bonusUser.bonusRequests = bonusUser.bonusRequests.filter(\n          (eachReq) => eachReq.reqId !== req.reqId\n        );\n\n        this.setState({\n          admin: bonusUser,\n        });\n        dispatch({\n          type: \"APPROVED_REJECTED_BONUS\",\n          payload: {\n            reqId: req.reqId,\n          },\n        });\n        break;\n\n      case \"loan request\":\n        let loanUser = this.state.admin;\n        loanUser.loanRequests = loanUser.loanRequests.filter(\n          (eachReq) => eachReq.reqId !== req.reqId\n        );\n\n        this.setState({\n          admin: loanUser,\n        });\n        dispatch({\n          type: \"APPROVED_REJECTED_LOAN\",\n          payload: {\n            reqId: req.reqId,\n          },\n        });\n        break;\n\n      default:\n        return;\n    }\n  };\n\n  onApprove = async (req, dispatch) => {\n    this.callDispatch(dispatch, req);\n\n    console.log(\"approving: \", req);\n\n    req.approved = true;\n    req.ticketClosed = true;\n\n    try {\n      const adminId = localStorage.getItem(\"userId\");\n      const res = await axios.put(\"/api/admin/takeAction\", {\n        userReq: req,\n        adminId: adminId,\n      });\n      console.log(\"approved successfully\", res.data);\n    } catch (e) {\n      console.log(\"Error: \", e.response.data.msg);\n    }\n  };\n\n  onReject = async (req, dispatch) => {\n    this.callDispatch(dispatch, req);\n\n    console.log(\"rejecting: \", req);\n\n    req.approved = false;\n    req.ticketClosed = true;\n\n    try {\n      const adminId = localStorage.getItem(\"userId\");\n      const res = await axios.put(\"/api/admin/takeAction\", {\n        userReq: req,\n        adminId: adminId,\n      });\n      console.log(\"rejected successfully: \", res.data);\n    } catch (e) {\n      console.log(\"Error: \", e.response);\n    }\n  };\n\n  render() {\n    return (\n      <Consumer>\n        {(value) => {\n          let { admin } = this.state;\n\n          let { user } = value;\n\n          const token = localStorage.getItem(\"auth-token\");\n\n          if (!token) return <Redirect to=\"/login\" />;\n          if (user && user.role !== \"admin\")\n            return <Redirect to=\"/empDashBoard\" />;\n\n          return (\n            <Spring\n              from={{ opacity: 0 }}\n              to={{ opacity: 1 }}\n              config={{ duration: 300 }}\n            >\n              {(props) => (\n                <>\n                  <div className=\"row m-0\">\n                    {/* left part */}\n                    <div className=\"col-2 p-0 leftPart\">\n                      <AdminSidePanel />\n                    </div>\n\n                    {/* right part */}\n                    <div className=\"col\" style={props}>\n                      <div className=\"container py-3\">\n                        <h3>\n                          Leave Requests{\" \"}\n                          <span\n                            className=\"badge badge-pill badge-dark\"\n                            style={{\n                              fontSize: \"15px\",\n                            }}\n                          >\n                            {admin && admin.leaveRequests.length}\n                          </span>{\" \"}\n                          <i\n                            style={{ cursor: \"pointer\" }}\n                            onClick={() =>\n                              this.setState({\n                                expandLeaveReq: !this.state.expandLeaveReq,\n                              })\n                            }\n                            className={classNames(\"fa\", {\n                              \"fa-caret-down\": !this.state.expandLeaveReq,\n                              \"fa-caret-up\": this.state.expandLeaveReq,\n                            })}\n                          ></i>\n                        </h3>\n\n                        {this.state.expandLeaveReq ? (\n                          <div\n                            style={{\n                              display: \"flex\",\n                              flexDirection: \"row\",\n                            }}\n                          >\n                            <div className=\"row\">\n                              {admin ? (\n                                admin.leaveRequests.length ? (\n                                  admin.leaveRequests.map((req, index) => {\n                                    return (\n                                      <LeaveRequestCard\n                                        key={index}\n                                        req={req}\n                                        onApprove={this.onApprove}\n                                        onReject={this.onReject}\n                                      />\n                                    );\n                                  })\n                                ) : (\n                                  <small className=\"ml-4\">\n                                    No leave requests pending...\n                                  </small>\n                                )\n                              ) : (\n                                <small className=\"ml-4\">\n                                  Loading leave requests...\n                                </small>\n                              )}\n                            </div>\n                          </div>\n                        ) : null}\n                        <hr />\n\n                        <h3>\n                          Bonus Requests{\" \"}\n                          <span\n                            className=\"badge badge-pill badge-dark\"\n                            style={{\n                              fontSize: \"15px\",\n                            }}\n                          >\n                            {admin && admin.bonusRequests.length}\n                          </span>{\" \"}\n                          <i\n                            style={{ cursor: \"pointer\" }}\n                            onClick={() =>\n                              this.setState({\n                                expandBonusReq: !this.state.expandBonusReq,\n                              })\n                            }\n                            className={classNames(\"fa\", {\n                              \"fa-caret-down\": !this.state.expandBonusReq,\n                              \"fa-caret-up\": this.state.expandBonusReq,\n                            })}\n                          ></i>\n                        </h3>\n\n                        {this.state.expandBonusReq ? (\n                          <div\n                            style={{\n                              display: \"flex\",\n                              flexDirection: \"row\",\n                            }}\n                          >\n                            <div className=\"row\">\n                              {admin ? (\n                                admin.bonusRequests.length ? (\n                                  admin.bonusRequests.map((req, index) => {\n                                    return (\n                                      <BonusRequestCard\n                                        key={index}\n                                        req={req}\n                                        onApprove={this.onApprove}\n                                        onReject={this.onReject}\n                                      />\n                                    );\n                                  })\n                                ) : (\n                                  <small className=\"ml-4\">\n                                    No bonus requests pending...\n                                  </small>\n                                )\n                              ) : (\n                                <small className=\"ml-4\">\n                                  Loading bonus requests...\n                                </small>\n                              )}\n                            </div>\n                          </div>\n                        ) : null}\n\n                        <hr />\n\n                        <h3>\n                          Loan Requests{\" \"}\n                          <div\n                            className=\"badge badge-pill badge-dark\"\n                            style={{\n                              fontSize: \"15px\",\n                            }}\n                          >\n                            {admin && admin.loanRequests.length}\n                          </div>{\" \"}\n                          <i\n                            style={{ cursor: \"pointer\" }}\n                            onClick={() =>\n                              this.setState({\n                                expandLoanReq: !this.state.expandLoanReq,\n                              })\n                            }\n                            className={classNames(\"fa\", {\n                              \"fa-caret-down\": !this.state.expandLoanReq,\n                              \"fa-caret-up\": this.state.expandLoanReq,\n                            })}\n                          ></i>\n                        </h3>\n\n                        {this.state.expandLoanReq ? (\n                          <div\n                            style={{\n                              display: \"flex\",\n                              flexDirection: \"row\",\n                            }}\n                          >\n                            <div className=\"row\">\n                              {admin ? (\n                                admin.loanRequests.length ? (\n                                  admin.loanRequests.map((req, index) => {\n                                    return (\n                                      <LoanRequestCard\n                                        key={index}\n                                        req={req}\n                                        onApprove={this.onApprove}\n                                        onReject={this.onReject}\n                                      />\n                                    );\n                                  })\n                                ) : (\n                                  <small className=\"ml-4\">\n                                    No loan requests pending...\n                                  </small>\n                                )\n                              ) : (\n                                <small className=\"ml-4\">\n                                  Loaing loan requests...\n                                </small>\n                              )}\n                            </div>\n                          </div>\n                        ) : null}\n                      </div>\n                    </div>\n                  </div>\n                </>\n              )}\n            </Spring>\n          );\n        }}\n      </Consumer>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}